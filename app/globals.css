import { useState, useEffect } from "react";
import Link from "next/link";
import { motion } from "framer-motion";

export default function Topbar({ username, onSignOut }) {
  const [isDark, setIsDark] = useState(false);

  useEffect(() => {
    document.body.classList.toggle("dark", isDark);
  }, [isDark]);

  return (
    <motion.nav
      className="topbar"
      initial={{ y: -50, opacity: 0 }}
      animate={{ y: 0, opacity: 1 }}
      transition={{ duration: 0.4, ease: "easeOut" }}
    >
      <div className="topbar-container">
        {/* Brand */}
        <Link href="/" className="brand">
          <span className="brand-icon">üåå</span>
          <span className="brand-name">Nebula</span>
        </Link>

        {/* Nav Menu */}
        <div className="nav-menu">
          <Link href="/" className="nav-item">Home</Link>
          <Link href="/docs" className="nav-item">Docs</Link>
        </div>

        {/* Right Menu */}
        <div className="right-menu">
          <button 
            className="icon-btn"
            onClick={() => setIsDark(!isDark)}
            aria-label="Toggle Dark Mode"
          >
            {isDark ? "‚òÄÔ∏è" : "üåô"}
          </button>
          <button 
            className="icon-btn" 
            onClick={onSignOut}
            aria-label="Sign Out"
          >
            üö™
          </button>
          <Link href="/profile" className="profile-avatar">
            {username?.[0]?.toUpperCase() || "U"}
          </Link>
        </div>
      </div>

      <style jsx>{`
        body {
          font-family: 'Inter', sans-serif;
          background: #f5f5f5;
          color: #1e1e1e;
          transition: background 0.3s ease, color 0.3s ease;
        }
        body.dark {
          background: #1e1e1e;
          color: #f5f5f5;
        }
        .topbar {
          background: transparent;
          padding: 1rem 2rem;
        }
        .topbar-container {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        .brand {
          display: flex;
          align-items: center;
          font-weight: 700;
          font-size: 1.2rem;
          gap: 0.5rem;
        }
        .nav-menu {
          display: flex;
          gap: 1.5rem;
        }
        .nav-item {
          color: inherit;
          text-decoration: none;
          font-weight: 500;
          transition: color 0.2s ease;
        }
        .nav-item:hover {
          color: #4caf50;
        }
        .icon-btn {
          background: none;
          border: none;
          font-size: 1.25rem;
          cursor: pointer;
          transition: transform 0.2s ease;
        }
        .icon-btn:hover {
          transform: scale(1.1);
        }
        .right-menu {
          display: flex;
          align-items: center;
          gap: 1rem;
        }
        .profile-avatar {
          width: 36px;
          height: 36px;
          background: #4caf50;
          color: white;
          font-weight: 700;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          text-decoration: none;
        }
      `}</style>
    </motion.nav>
  );
}
